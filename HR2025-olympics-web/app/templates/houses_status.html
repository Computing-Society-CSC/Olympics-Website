{% extends "base.html" %}

{% block css_style %}
:root {
    --rank-color: #f5f5f5;
    --rank-hover: #e0e0e0;
    --font-color-dark: #333;
    --points-bar-bg: #ddd;
    --points-bar-fill: var(--accent-color);
}

.container {
    width: 90%;
    max-width: 800px;
    margin: 2rem auto;
}

.rankings {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.house-card {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    padding: 1rem;
    border-radius: 8px;
    background-color: var(--rank-color);
    transition: background-color 0.3s ease, transform 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    border-left: 8px solid;
}

.house-card:hover {
    background-color: var(--rank-hover);
    transform: translateY(-5px);
}

.house-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.house-rank {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--font-color-dark);
}

.house-name {
    font-size: 1.2rem;
    font-weight: bold;
    text-transform: capitalize;
    color: var(--font-color-dark);
}

.house-points {
    font-size: 1rem;
    font-weight: normal;
    color: var(--font-color-dark);
}

/* Points Bar */
.points-bar {
    position: relative;
    width: 100%;
    height: 8px;
    background-color: var(--points-bar-bg);
    border-radius: 4px;
    overflow: hidden;
    margin-top: 0.5rem;
}

.points-bar-fill {
    height: 100%;
    background-color: var(--points-bar-fill);
    width: 0%; /* Will be set inline */
    transition: width 0.3s ease;
}

@media (max-width: 600px) {
    .house-card {
        padding: 0.8rem;
    }
    .house-rank {
        font-size: 1.2rem;
    }
    .house-name {
        font-size: 1rem;
    }
    .house-points {
        font-size: 0.9rem;
    }
}
{% endblock %}

{% block content %}
<div class="container">
    <h2>Houses Rankings</h2>
    {% set max_points = house_rankings | map(attribute='points') | max %}
    <div class="rankings">
        {% for house in house_rankings %}
        <div class="house-card" style="border-left-color: {{ color_map[house.name] | default('#ccc') }}">
            <div class="house-header">
                <span class="house-rank">#{{ house.rank }}</span>
                <span class="house-name">{{ house.name }}</span>
                <span class="house-points">{{ house.points }} Points</span>
            </div>
            <div class="points-bar">
                {% set width_percentage = (house.points / max_points * 100) if max_points > 0 else 0 %}
                <div class="points-bar-fill" style="width: {{ width_percentage }}%;"></div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}